import json

import bs4
import cloudscraper as cloudscraper

url = 'https://cloud.google.com/speech-to-text/docs/languages'

scraper = cloudscraper.create_scraper()
request_result = scraper.get(url)

soup = bs4.BeautifulSoup(request_result.text, "html.parser")

data = {}
table_div = soup.find('div', {'id': 'lang-table-container'})
table = table_div.find('table')
table_body = table.find('tbody')

rows = table_body.find_all('tr')
for row in rows:
    cols = row.find_all('td')
    cols = [element.text.strip() for element in cols]
    data[cols[0]] = cols[1]

json_data = json.dumps(data)

with open('../static/assets/speech_supported_languages.json', 'w') as outfile:
    json.dump(data, outfile)

